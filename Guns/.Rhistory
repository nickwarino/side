# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(1,.5))
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7))
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
My_Theme = theme(
axis.title.x = element_text(size = 20),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Test theme
My_Theme = theme(
axis.title.x = element_text(size = 20),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7))
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Test theme
My_Theme = theme(
plot.title = element_text(size+24)
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Test theme
My_Theme = theme(
plot.title = element_text(size+30)
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Test theme
My_Theme = theme(
plot.title = element_text(size=30)
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
My_Theme = theme(
plot.title = element_text(size = 30)
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Test theme
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16),)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
ggsave("docs/gun_deaths.png", width=15, height=15, units="in", useDingbats=FALSE)
ggsave(device = png, "docs/gun_deaths.png", width=15, height=15, units="in", useDingbats=FALSE)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE) +
ggsave(device = png, "docs/gun_deaths.png", width=15, height=15, units="in", useDingbats=FALSE)
# Test theme
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
ggsave("docs/gun_deaths.png", width=15, height=15, units="in", useDingbats=FALSE)
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16))
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
ggsave("docs/gun_deaths.png", width=15, height=15, units="in")
# Test theme
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16),
plot.background = "white"
)
# Test theme
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16),
plot.background = "white"
)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
ggsave("docs/gun_deaths.png", width=15, height=15, units="in")
# Test theme
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16),
plot.background = element_rect(fill="white", color="black")
)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
ggsave("docs/gun_deaths.png", width=15, height=15, units="in")
# Test theme
My_Theme = theme(
plot.title = element_text(size = 30),
axis.title.x = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
axis.text.y = element_text(size = 16),
plot.background = element_rect(fill="white", color="black")
)
# Step 4: visualize data by creating 4 variable bubble plot
# get median for gun deaths
mid_gun_deaths<-mean(gun_data$GunDeathPerc, na.rm=TRUE)
ggplot(gun_data,
aes(x=FirearmHouseholdPerce,
y=HandgunHouseholdPerc,
size=GunsPerc))+
geom_point(alpha=0.7, shape=21, color='black', aes(fill=GunDeathPerc)) +
scale_fill_gradient2(midpoint=mid_gun_deaths, low="blue", mid="white",
high="red", space ="Lab", name="Gun Deaths Per 100K People") +
scale_size(range = c(1, 24)) +
geom_text_repel(aes(label=Location), size=3, color="black") +
theme_minimal()+
labs(title="Lots of guns in America",
subtitle="OECD Countries, Latest year available",
caption="source: https://en.wikipedia.org/wiki/Percent_of_households_with_guns_by_country, https://en.wikipedia.org/wiki/Estimated_number_of_civilian_guns_per_capita_by_country, https://worldpopulationreview.com/country-rankings/gun-deaths-by-country",
x="% Households With Gun",
y="% Households with Hand Gun",
size="Guns Per 100 People",
color="Gun Deaths Per 100K People") +
theme(legend.position=c(.9,.7)) +
My_Theme
ggsave("docs/gun_deaths.pdf", width=15, height=15, units="in", useDingbats=FALSE)
ggsave("docs/gun_deaths.png", width=15, height=15, units="in")
